{% extends "layout.html" %}
{% load static %}
{% block css %}
<link rel="stylesheet" href="{% static 'css/secure_notes.css' %}">
{% endblock %}
{% block content %}
<div class="container py-3">

  <h3 class="Securetitle mb-1 text-break">{{ note.title|default:"(untitled)" }}</h3>

  <p class="text-muted small">
    Created: {{ note.created_at|date:"Y-m-d H:i" }} â€¢ 
    Updated: {{ note.updated_at|date:"Y-m-d H:i" }}
  </p>

  {% if decrypted_text %}

    <div class="card mb-3 shadow-sm">
      <div class="card-body">
        <pre class="note-content">{{ decrypted_text }}</pre>
      </div>
    </div>

    <div class="view-actions mt-3">
      <a class="btn btn-secondary" href="{% url 'secure_notes_list' %}">Back</a>
    </div>

  {% else %}

    <p class="text-muted">This note is encrypted. Enter your account password to decrypt:</p>

    <form method="post" class="mt-3">
      {% csrf_token %}

      {{ form.passphrase.label_tag }}
      {{ form.passphrase }}

      <div class="view-actions mt-3">
        <button class="btn unlockedbtn" type="submit">Unlock</button>
        <a class="btn btn-secondary" href="{% url 'secure_notes_list' %}">Back</a>
      </div>
    </form>

  {% endif %}
</div>

{% endblock %}
